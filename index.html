<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Amigo Secreto üéÑ</title>
    <link rel="stylesheet" href="style.css">
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&family=Mountains+of+Christmas:wght@400;700&family=Playfair+Display:wght@400;600;700&family=Poppins:wght@400;600&display=swap"
        rel="stylesheet">
    <!-- FontAwesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Anime.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <!-- html2pdf.js for PDF download -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>

<body>

    <!-- Snowfall Container -->
    <div id="snow-container"></div>

    <!-- Music Player Widget -->
    <div class="music-player">
        <img src="img.jpg" alt="Cover" class="album-art">
        <div class="music-info">
            <span id="music-status"><i class="fas fa-play"></i> Play</span>
            <span id="song-name">Feliz Navidad para todos...</span>
        </div>
    </div>

    <main class="container">
        <!-- VIEW: SETUP / ADMIN -->
        <section id="setup-view" class="view active">
            <header class="header">
                <h1>üéÖ Amigo Secreto</h1>
                <p>Organiza tu sorteo navide√±o f√°cil y r√°pido.</p>
            </header>

            <div class="card glass-effect">
                <div class="input-group">
                    <input type="text" id="name-input" placeholder="Nombre del participante..."
                        onkeypress="handleEnter(event)">
                    <button id="add-btn" class="btn-primary"><i class="fas fa-plus"></i> A√±adir</button>
                </div>

                <ul id="participants-list" class="list-group">
                    <!-- Dynamic List -->
                </ul>

                <div class="actions">
                    <button id="draw-btn" class="btn-cta" disabled>üé≤ Realizar Sorteo</button>
                    <button id="reset-btn" class="btn-secondary hidden">üîÑ Reiniciar</button>
                </div>
            </div>

            <!-- Results Section (Initially Hidden) -->
            <div id="results-area" class="card glass-effect hidden" style="margin-top: 20px;">
                <span>Para compartir los links con los participantes</span>
                <h2>üéÅ Links Generados</h2>
                <p class="instruction">Env√≠a a cada persona SU link privado. No los abras t√∫ o arruinar√°s la sorpresa.
                </p>
                <ul id="links-list" class="list-group"></ul>
            </div>
        </section>

        <!-- VIEW: REVEAL / PLAYER -->
        <section id="reveal-view" class="view hidden">
            <div class="gift-container">
                <div class="gift-box" id="gift-box">
                    <div class="lid">
                        <div class="bow"></div>
                    </div>
                    <div class="box"></div>
                </div>
                <div class="message-container glass-effect">
                    <h2 id="recipient-greeting">¬°Hola! üéÑ</h2>
                    <p>Alguien te ha enviado un regalo secreto.</p>
                    <button id="reveal-btn" class="btn-cta">üéÅ Abrir Regalo</button>
                </div>
            </div>

            <!-- Result Overlay -->
            <div id="final-reveal" class="overlay hidden">
                <div class="reveal-content glass-effect premium-card">
                    <div class="decor-corner top-left"><i class="fas fa-holly-berry"></i></div>
                    <div class="decor-corner top-right"><i class="fas fa-candy-cane"></i></div>

                    <div class="reveal-header">
                        <h1>üéÖ Feliz Navidad TonotosüéÖ</h1>
                        <p class="subtitle">Debes prepararle un regalo a:</p>
                    </div>

                    <div class="match-container">
                        <h2 id="match-name" class="big-reveal">---</h2>
                    </div>

                    <!-- Step 2: Description Form -->
                    <div id="step-form" class="reveal-footer">
                        <label for="desc-words" class="instruction-label">üëá Describe a esta persona con 1 o 2
                            caracter√≠sticas:</label>
                        <div class="input-row">
                            <input type="text" id="desc-words" class="premium-input"
                                placeholder="Ej: Mala copa, Migajero">
                        </div>
                        <button id="params-btn" class="btn-gold">üìú Generar Certificado</button>
                    </div>

                    <!-- Loading State -->
                    <div id="loading-state" class="hidden">
                        <div class="spinner"></div>
                        <p>Los venecos est√°n redactando el certificado...</p>
                    </div>
                </div>
            </div>

            <!-- CERTIFICATE MODAL -->
            <div id="certificate-modal" class="overlay hidden">
                <div class="certificate-paper" id="printable-cert">
                    <div class="cert-border">
                        <div class="cert-content">
                            <!-- Esquinas decorativas -->
                            <div class="corner-decor top-left">‚ùß</div>
                            <div class="corner-decor top-right">‚ùß</div>
                            <div class="corner-decor bottom-left">‚ùß</div>
                            <div class="corner-decor bottom-right">‚ùß</div>

                            <h1 class="cert-title">CERTIFICADO DE<br>RECONOCIMIENTO</h1>

                            <div class="cert-subtitle-container">
                                <h2 id="cert-attributes" class="cert-subtitle">---</h2>
                                <div class="separator-line"></div>
                            </div>

                            <div class="cert-recipient">
                                <h2 id="cert-name">NOMBRE DEL JUGADOR</h2>
                            </div>

                            <div class="cert-body">
                                <p id="cert-description">Aqu√≠ ir√° la descripci√≥n generada por la IA...</p>
                            </div>

                            <div class="cert-footer">
                                <div class="logo-area">
                                    <img src="logo.png" alt="ChupiReunion Logo" class="cert-logo">
                                    <span>ChupiReunion 2025</span>
                                </div>
                                <div class="seal">
                                    <img src="estampa.png" alt="Estampa Oficial" class="stamp-img">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="cert-actions">
                    <button id="edit-tags-btn" class="btn-secondary"><i class="fas fa-tags"></i> Cambiar
                        Caracteristicas</button>
                    <button id="regen-btn" class="btn-secondary"><i class="fas fa-sync-alt"></i> Regenerar</button>
                    <button id="download-pdf-btn" class="btn-primary"><i class="fas fa-file-pdf"></i> Descargar
                        PDF</button>
                    <button id="print-btn" class="btn-secondary"><i class="fas fa-print"></i> Imprimir</button>
                    <button id="close-cert" class="btn-secondary">Cerrar</button>
                </div>
            </div>
            </div>
        </section>

        <!-- ERROR VIEW -->
        <section id="error-view" class="view hidden">
            <div class="card glass-effect error-card">
                <h2>üö´ Ups...</h2>
                <p>Este link parece inv√°lido o roto.</p>
                <a href="/" class="btn-secondary">Volver al Inicio</a>
            </div>
        </section>
    </main>

    <audio id="bg-music" loop>
        <source src="https://example.com/jingle-bells.mp3" type="audio/mp3">
        <!-- Placeholder for now, will add real music later -->
    </audio>

    <script src="script.js"></script>
</body>

</html>